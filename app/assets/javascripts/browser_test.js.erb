function googleAnalytics(){
	if (typeof _gat ===  'undefined') {
		other_site = other_site + ', ' + "Google Analytics: Not Loaded";
		other_sites_display = other_sites_display + ', ' + "Google Analytics: Not Loaded";
    }else{
		other_site = other_site + ', ' + "Google Analytics: Loaded";
    }
}
function liveChat() {
    if (typeof LC_API === 'undefined') {
		other_site = other_site + ', ' + "LiveChat: Not Loaded";
		other_sites_display = other_sites_display + ', ' + "LiveChat: Not Loaded";
    }else{
		other_site = other_site + ', ' + "LiveChat: Loaded";
    }
}
function googlejsapi(){
	if (typeof google.loader === 'undefined') {
		other_site = other_site + ', ' + "jsapi: Not Loaded";
		other_sites_display = other_sites_display + ', ' + "jsapi: Not Loaded";
    }else{
		other_site = other_site + ', ' + "jsapi: Loaded";
    }	
}
function testWithImage(imageID ,width, height, title){
	if($(imageID).width() == width && $(imageID).height() == height){
		other_site = other_site + ', ' + title + ": Loaded";
	}else{
		other_site = other_site + ', ' + title + ": Not Loaded";
		other_sites_display = other_sites_display + ', ' + title + ": Not Loaded";
	}
}
function replaceStyle(domID)
{
	$(domID).parents(".alert").removeClass("grey").removeClass('alert-error').addClass("alert-success");
}
function replaceStyleFalse(domID)
{
	$(domID).parents(".alert").removeClass("grey").addClass("alert-error");
}

//Google Analytics 
var _gaq = _gaq || [];
    _gaq.push(['_setAccount', '<%= ENV["gaA"]%>']);
    _gaq.push(['_trackPageview']);
//honey badger
$(function(){ Honeybadger.configure({
        api_key: '097b0947f2920dc6355327d2c1c2d1f8', // Public API key
      });
      try {
        testAll();
      } catch(e) {
      	Honeybadger.notify(e);
      }
});

//3rd party sites variables
var other_site = "";
var other_sites_display = "";

function testAll(){
	//fades notices after appearing
	$('#flash').slideUp(4000);

	//loading data from client
	if(navigator.userAgent == undefined){
		replaceStyleFalse("#userAgent");
		$("#userAgent").text("Undefined");
		$("#user_datum_user_agent_string").val("Undefined");
	}else{
		$("#userAgent").text(navigator.userAgent);
		replaceStyle("#userAgent");
		$("#user_datum_user_agent_string").val(navigator.userAgent);
	}	
	
	if(window.session.device.viewport.width == undefined && window.session.device.viewport.height == undefined){
		$("#windowSize").text("Undefined");
		replaceStyleFalse("#windowSize");
		$("#user_datum_window_size").val("Undefined");
	}else{
		$("#windowSize").text( window.session.device.viewport.width + " x "+ window.session.device.viewport.height);
		replaceStyle("#windowSize");
		$("#user_datum_window_size").val(window.session.device.viewport.width + " x "+ window.session.device.viewport.height);
	}
	
	if(window.session.device.screen.width == undefined && window.session.device.screen.height == undefined){
		$("#screenSize").text("Undefined");
		replaceStyleFalse("#screenSize");
		$("#user_datum_screen_size").val("Undefined");
	}else{
		$("#screenSize").text(window.session.device.screen.width + " x " + window.session.device.screen.height);
		replaceStyle("#screenSize");
		$("#user_datum_screen_size").val(window.session.device.screen.width + " x " + window.session.device.screen.height);
	}
	
	if(window.session.browser.os == undefined){
		$("#os").text("Undefined");
		replaceStyleFalse("#os");
		$("#user_datum_operating_system").val("Undefined");
	}else{
		$("#os").text(window.session.browser.os);
		replaceStyle("#os");
		$("#user_datum_operating_system").val(window.session.browser.os);
	}
	
	if(window.session.browser.browser == undefined && window.session.browser.version == undefined){
		$("#browser").text("Undefined");
		replaceStyleFalse("#browser");
		$("#user_datum_web_browser").val("Undefined");
	}else{
		$("#browser").text(window.session.browser.browser + " Version: " + window.session.browser.version);
		replaceStyle("#browser");
		$("#user_datum_web_browser").val(window.session.browser.browser + " Version: " + window.session.browser.version);
	}
	
	if(window.session.plugins.flash == true && window.session.plugins.flash != undefined){
		$("#flashEnabled").text(window.session.plugins.flash);
		replaceStyle("#flashEnabled");
		$("#user_datum_flash_enabled").val(window.session.plugins.flash);
	}else{
		$("#flashEnabled").text("False");
		replaceStyleFalse("#flashEnabled");
		$("#user_datum_flash_enabled").val("False");
	}
	if(Date() == undefined){
		$("#date").text("Undefined");
		replaceStyleFalse("#date");
		$("#user_datum_date").val("Undefined");
	}else{
		$("#date").text(Date());
		replaceStyle("#date");
		$("#user_datum_date").val(Date());
	}

	//Load data from control site https://control.continuity.net/favicon.ico
	if($("#imagefavicon").width() == 32 && $("#imagefavicon").height() == 32){
		$("#continuity").text("Loaded");
		replaceStyle("#continuity");
		$("#user_datum_continuity_site").val("Loaded");

	}else{
		$("#continuity").text("Not Loaded");
		replaceStyleFalse("#continuity");
		$("#user_datum_continuity_site").val("Not Loaded");
	}

	//loading data from 3rd party sites 
   	//beacon-1.newrelic.com - JavaScript performance monitoring
   	if(typeof NREUMQ === 'undefined'){
		other_site = other_site  + "NewRelic: Not Loaded";
		other_sites_display = "NewRelic: Not Loaded";
	}else{
		other_site = other_site + "NewRelic: Loaded";
	}

    //*.livechatinc.com (include all subdomains) - Customer Support
    liveChat();
    
    //google.com/jsapi - Google for CDN of JS libraries
    googlejsapi();

    //ssl.google-analytics.com - Site-usage analytics
    googleAnalytics();

    //d2b75q7u5jtkag.cloudfront.net - Continuity Control's Content CDN
    if(typeof control.datepicker_opts === 'undefined'){
		other_site = other_site + ', ' + "CloudFront(d2b75q7u5jtkag): Not Loaded";
		other_sites_display = other_sites_display +', ' + "CloudFront(d2b75q7u5jtkag): Not Loaded";
	}else{
		other_site = other_site + ', ' + "CloudFront(d2b75q7u5jtkag): Loaded";
	}
	//d1ros97qkrwjf5.cloudfront.net - JavaScript performance monitoring
   	testWithImage("#imagecloudfront",910, 44, "Cloud Front(d1ros97qkrwjf5)");

    //Honey badger
    
    if(typeof Honeybadger === 'undefined'){
		other_site = other_site + ', ' + "HoneyBadger: Not Loaded";
		other_sites_display = other_sites_display +', ' + "HoneyBadger: Not Loaded";
    } else {
		other_site = other_site + ', ' + "HoneyBadger: Loaded";
    }

    //display data for 3rd party tests on web browser
	if(other_sites_display.length <= 0){
		$("#3rdparty").text("All Sites work");
		replaceStyle("#3rdparty");
	}else{
		$("#3rdparty").text(other_sites_display);
		replaceStyleFalse("#3rdparty");
	}
	// add data for 3rd party tests to email 
	$("#user_datum_other_sites").val(other_site);
};